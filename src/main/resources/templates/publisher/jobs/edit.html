<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Job</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* Reset */
        *{margin:0;padding:0;box-sizing:border-box}
        body{
            font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x:hidden;
            background:#0f0c29;
            color:#fff;
            min-height:100vh;
        }

        /* Animated background */
        .animated-bg{
            position:fixed; inset:0;
            background:linear-gradient(-45deg,#0f0c29,#302b63,#24243e,#141E30);
            background-size:400% 400%;
            animation:gradientShift 15s ease infinite;
            z-index:-2;
        }
        @keyframes gradientShift{
            0%{background-position:0% 50%}
            50%{background-position:100% 50%}
            100%{background-position:0% 50%}
        }
        .particles{position:fixed; inset:0; z-index:-1; overflow:hidden}
        .particle{
            position:absolute;width:4px;height:4px;border-radius:50%;
            background:rgba(255,255,255,.5);animation:float linear infinite
        }
        @keyframes float{
            0%{transform:translateY(100vh) rotate(0);opacity:0}
            10%{opacity:1}
            90%{opacity:1}
            100%{transform:translateY(-100vh) rotate(360deg);opacity:0}
        }

        /* Header (glass) */
        .page-header{
            max-width:1100px;margin:24px auto 18px;padding:18px 22px;
            background:rgba(255,255,255,.06);
            border:1px solid rgba(255,255,255,.12);
            border-radius:16px;
            backdrop-filter:blur(10px);
            display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;
        }
        .page-header h1{
            font-size:2.1em;font-weight:900;
            background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            -webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;
        }
        .back-link{
            text-decoration:none;color:#fff;font-weight:700;border-radius:50px;
            padding:10px 18px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            box-shadow:0 8px 28px rgba(102,126,234,.35);transition:.3s;display:inline-flex;gap:8px;align-items:center
        }
        .back-link:hover{transform:translateY(-2px);box-shadow:0 14px 36px rgba(102,126,234,.55)}

        /* Container */
        .container{
            max-width:1100px;margin:0 auto 60px; padding:0 16px;
            position:relative; z-index:1;
        }

        /* Form card (glass) */
        .card{
            background:rgba(255,255,255,.06);
            border:1px solid rgba(255,255,255,.15);
            border-radius:16px;
            backdrop-filter:blur(10px);
            box-shadow:0 10px 28px rgba(0,0,0,.25);
            padding:24px 22px;
        }
        .section-title{
            font-size:1.2em; font-weight:800; margin-bottom:12px;
            color:#fff; letter-spacing:.3px;
        }
        .divider{height:1px;background:rgba(255,255,255,.12);margin:16px 0 8px}

        /* Alerts */
        .alert{
            background:rgba(255,255,255,.08);
            border:1px solid rgba(255,255,255,.18);
            border-left:4px solid #e74c3c;
            color:#fff;border-radius:12px;padding:14px 16px;margin-bottom:16px;
            backdrop-filter:blur(8px);font-weight:600
        }

        /* Form elements – apply also to included fragment */
        form label{
            display:block;margin:14px 0 6px;
            font-weight:700;color:rgba(255,255,255,.9)
        }
        input[type="text"],input[type="url"],input[type="number"],textarea,select{
            width:100%;padding:12px 12px;border-radius:10px;font-size:1em;font-family:inherit;
            color:#fff;background:rgba(255,255,255,.06);
            border:1px solid rgba(255,255,255,.18);
            outline:none;transition:border-color .2s, box-shadow .2s;
        }
        input::placeholder,textarea::placeholder{color:rgba(255,255,255,.6)}
        textarea{resize:vertical;min-height:110px}
        select[multiple]{min-height:150px}
        input:focus,textarea:focus,select:focus{
            border-color:#7f8cff; box-shadow:0 0 0 3px rgba(127,140,255,.15)
        }
        .error-message{color:#ff9e9e;font-size:.9em;margin-top:6px;font-weight:700}

        /* Buttons */
        .button-group{display:flex;gap:12px;justify-content:center;margin-top:22px;flex-wrap:wrap}
        .btn{
            padding:12px 26px;border:none;border-radius:12px;font-size:1.05em;font-weight:800;cursor:pointer;
            transition:.25s;display:inline-flex;align-items:center;gap:10px;text-decoration:none
        }
        .btn-primary{
            background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;
            box-shadow:0 8px 26px rgba(102,126,234,.35)
        }
        .btn-primary:hover{transform:translateY(-2px);box-shadow:0 14px 34px rgba(102,126,234,.55)}
        .btn-secondary{
            background:rgba(255,255,255,.1);color:#fff;border:1px solid rgba(255,255,255,.2)
        }
        .btn-secondary:hover{transform:translateY(-2px);background:rgba(255,255,255,.18)}

        @media (max-width:768px){
            .page-header{padding:14px 16px}
            .page-header h1{font-size:1.8em}
            .btn{width:100%;justify-content:center}
        }
    </style>
</head>
<body>
<!-- animated background -->
<div class="animated-bg"></div>
<div class="particles" id="particles"></div>

<!-- header -->
<div class="page-header">
    <h1>Edit Job</h1>
    <a th:href="@{/publisher/jobs}" class="back-link"><i class="fas fa-arrow-left"></i> Back to Job List</a>
</div>

<div class="container">
    <!-- form card -->
    <div class="card">
        <div class="section-title"><i class="fas fa-pen-to-square"></i> Job Details</div>
        <div class="divider"></div>

        <form th:action="@{/publisher/jobs/{id}(id=${jobId})}" th:object="${form}" method="post">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

            <!-- ✅ שגיאות בתוך הטופס (עם th:object) -->
            <div th:if="${#fields.hasAnyErrors()}" class="alert">
                <strong>Form Errors:</strong>
                <ul style="margin:10px 0 0 18px">
                    <li th:each="err : ${#fields.allErrors()}" th:text="${err}">Error</li>
                </ul>
            </div>

            <!-- כאן נטען את הטופס החלקי שלך -->
            <div th:replace="~{publisher/jobs/jobs_form :: jobForm}"></div>

            <div class="button-group">
                <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Save Changes</button>
                <a th:href="@{/publisher/jobs}" class="btn btn-secondary"><i class="fas fa-xmark"></i> Cancel</a>
            </div>
        </form>
    </div>
</div>

<!-- footer include (בתוך body) -->
<div th:replace="fragments/footer :: footer"></div>

<script>
    // particles
    (function(){
        const c = document.getElementById('particles'); if(!c) return;
        const n = 40;
        for(let i=0;i<n;i++){
            const p = document.createElement('div');
            p.className='particle';
            p.style.left = Math.random()*100 + '%';
            p.style.animationDuration = (Math.random()*10 + 10) + 's';
            p.style.animationDelay = (Math.random()*5) + 's';
            const s = (Math.random()*4 + 2) + 'px';
            p.style.width = s; p.style.height = s;
            c.appendChild(p);
        }
    })();
</script>
</body>
</html>